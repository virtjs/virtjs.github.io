<!doctype html>
<html>

    <head>

        <meta charset="utf-8" />

        <title>
            Virtjs
            
                - Extra Events
            
        </title>

        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootswatch/3.2.0+1/simplex/bootstrap.min.css" />
        <link rel="stylesheet" href="/styles/default.css" />

        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/js/collapse.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/js/dropdown.min.js"></script>

    </head>

    <body>

        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">Virtjs</a>
                </div>

                <div class="collapse navbar-collapse" id="navigation">
                    <ul class="nav navbar-nav">
                        
                        

    

        

            <li>
                <a href="/about/">
                    About
                </a>
            </li>

        

    

        

            <li>
                <a href="/news/">
                    News
                </a>
            </li>

        

    

        

            <li>
                <a href="/examples/">
                    Examples
                </a>
            </li>

        

    

        

            <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" id="documentation" href="#">
                    Documentation <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" aria-labelledby="documentation">
                    

    

        

            <li>
                <a href="/documentation/getting-started/">
                    Getting Started
                </a>
            </li>

        

    

        

            <li>
                <a href="/documentation/instanciating-an-emulator/">
                    Instanciating an Emulator
                </a>
            </li>

        

    

        

            <li>
                <a href="/documentation/standard-devices/">
                    Standard Devices
                </a>
            </li>

        

    


                </ul>
            </li>

        

    

        

            <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" id="developers" href="#">
                    Developers <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" aria-labelledby="developers">
                    

    

        

            <li>
                <a href="/developers/implementing-a-device/">
                    Implementing a Device
                </a>
            </li>

        

    

        

            <li>
                <a href="/developers/extra-events/">
                    Extra Events
                </a>
            </li>

        

    


                </ul>
            </li>

        

    

        

            <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" id="more" href="#">
                    More <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" aria-labelledby="more">
                    

    

        

            <li>
                <a href="/more#contact">
                    Contact
                </a>
            </li>

        

    

        

            <li>
                <a href="/more#legal">
                    Legal
                </a>
            </li>

        

    


                </ul>
            </li>

        

    


                    </ul>
                </div>

            </div>
        </nav>

        

    <div class="container">
        <div class="row">

            <nav class="col-md-4 col-md-push-8">
                <div class="list-group article-navigation">
                    
                        
                            <a class="list-group-item" href="/developers/implementing-a-device/">
                                Implementing a Device
                            </a>
                        
                    
                        
                            <a class="list-group-item active" href="/developers/extra-events/">
                                Extra Events
                            </a>
                        
                    
                </div>
            </nav>

            <article class="col-md-8 col-md-pull-4">
                <div class="page-header"><h1 id="extra-events">Extra Events</h1></div><p>In some cases, you may want to hook some parts of the engine while it&#39;s running. In most emulators, such a thing can be very difficult since they are not really made for being extended at runtime. Virtjs is different, and allows you to choose between performances and extensibility by exposing events. All of them are totally optionals, and will be disabled if you do not explicitely ask for their namespaces when instanciating your engine.</p>
<h2 id="usage">Usage</h2><pre><code><span class="line"><span class="token keyword" >import</span> <span class="token punctuation" >{</span> Engine <span class="token punctuation" >}</span> <span class="token keyword" >from</span> <span class="token string" >'virtjs/arch/gb/Engine'</span><span class="token punctuation" >;</span></span><span class="line"></span><span class="line"><span class="token keyword" >var</span> engine <span class="token operator" >=</span> <span class="token keyword" >new</span> <span class="token class-name" >Engine</span><span class="token punctuation" >(</span> <span class="token punctuation" >{</span> events <span class="token punctuation" >:</span> <span class="token punctuation" >[</span></span><span class="line">    <span class="token string" >'setup'</span><span class="token punctuation" >,</span>      <span class="token comment" spellcheck="true">// enable the 'setup' event</span></span><span class="line">    <span class="token string" >'read'</span><span class="token punctuation" >,</span>       <span class="token comment" spellcheck="true">// enable the 'read' event</span></span><span class="line">    <span class="token string" >'write'</span><span class="token punctuation" >,</span>      <span class="token comment" spellcheck="true">// enable the 'write' and 'post-write' events</span></span><span class="line">    <span class="token string" >'instruction'</span> <span class="token comment" spellcheck="true">// enable the 'instruction' event</span></span><span class="line"><span class="token punctuation" >]</span> <span class="token punctuation" >}</span> <span class="token punctuation" >)</span><span class="token punctuation" >;</span></span><span class="line"></span><span class="line">engine<span class="token punctuation" >.</span><span class="token function" >on<span class="token punctuation" >(</span></span> <span class="token string" >'setup'</span><span class="token punctuation" >,</span> <span class="token punctuation" >(</span> <span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span></span><span class="line">    console<span class="token punctuation" >.</span><span class="token function" >log<span class="token punctuation" >(</span></span> <span class="token string" >'engine setup'</span> <span class="token punctuation" >)</span><span class="token punctuation" >;</span></span><span class="line"><span class="token punctuation" >}</span> <span class="token punctuation" >)</span><span class="token punctuation" >;</span></span><span class="line"></span><span class="line">engine<span class="token punctuation" >.</span>mmu<span class="token punctuation" >.</span><span class="token function" >on<span class="token punctuation" >(</span></span> <span class="token string" >'write'</span><span class="token punctuation" >,</span> address <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span></span><span class="line">    <span class="token comment" spellcheck="true">// *(0) == 0, *(1) == 1, ...</span></span><span class="line">    <span class="token comment" spellcheck="true">// will probably break everything :)</span></span><span class="line">    <span class="token keyword" >return</span> address<span class="token punctuation" >;</span></span><span class="line"><span class="token punctuation" >}</span> <span class="token punctuation" >)</span><span class="token punctuation" >;</span></span></code></pre><h2 id="event-list">Event list</h2><p>Here is the list of the events for standard engines (each engine expose its own events, even if most of them share the same names and parameters).</p>
<h3 id="gameboy">Gameboy</h3><h4 id="setup">setup</h4><p><strong>Available on <code>engine</code> with the <code>setup</code> namespace.</strong></p>
<p>Emitted after an environment is bound to an engine.</p>
<h4 id="error">error</h4><p><strong>Available on <code>engine</code> with the <code>error</code> namespace</strong></p>
<p>Emitted when an instruction triggers an error.</p>
<h4 id="start">start</h4><p><strong>Available on <code>engine</code> with the <code>start</code> namespace</strong></p>
<p>Emitted when the execution resumes.</p>
<h4 id="stop">stop</h4><p><strong>Available on <code>engine</code> with the <code>start</code> namespace</strong></p>
<p>Emitted when the execution pauses.</p>
<h4 id="instruction-address-opcode-breakrequested-">instruction (address, opcode, breakRequested)</h4><p><strong>Available on <code>engine.interpreter</code> with the <code>instruction</code> namespace.</strong></p>
<p>Emitted before the emulator execute an instruction.</p>
<div class="alert alert-info" role="alert">
    <code>breakRequested</code> is writable: you can set it to <code>true</code> (default <code>false</code>). If you do so, the emulator will leave the execution before actually executing the instruction.
</div>

<div class="alert alert-warning" role="alert">
    <strong>Be careful</strong>, doing something like this would prevent the emulator from going further, since you would always break when resuming:
</div>

<pre><code><span class="line">engine<span class="token punctuation" >.</span>interpreter<span class="token punctuation" >.</span><span class="token function" >on<span class="token punctuation" >(</span></span> <span class="token string" >'instruction'</span><span class="token punctuation" >,</span> event <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span></span><span class="line">    event<span class="token punctuation" >.</span>breakRequested <span class="token operator" >=</span> <span class="token keyword" >true</span><span class="token punctuation" >;</span></span><span class="line"><span class="token punctuation" >}</span> <span class="token punctuation" >)</span><span class="token punctuation" >;</span></span></code></pre><h4 id="read-address-value-">read (address, value)</h4><p><strong>Available on <code>engine.mmu</code> with the <code>read</code> namespace.</strong></p>
<p>Emitted when the emulator wants to know the data at some place in the memory.</p>
<div class="alert alert-info" role="alert">
    <code>value</code> is writable: you can set it to something else than <code>undefined</code>, and the emulator will return this value rather than the actual one.
</div>

<h4 id="write-address-value-">write (address, value)</h4><p><strong>Available on <code>engine.mmu</code> with the <code>write</code> namespace.</strong></p>
<p>Emitted right before writing something somewhere.</p>
<div class="alert alert-info" role="alert">
    <code>value</code> is writable: you can set it to something else, and the emulator will return this value rather than the actual one.
</div>

<h4 id="post-write-address-value-">post-write (address, value)</h4><p><strong>Available on <code>engine.mmu</code> with the <code>write</code> namespace.</strong></p>
<p>Emitted right <em>after</em> writing something somewhere.</p>

            </article>

        </div>
    </div>



    </body>

</html>
